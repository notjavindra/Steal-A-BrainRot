local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/ionlyusegithubformcmods/1-Line-Scripts/main/Mobile%20Friendly%20Orion')))()
local Player = game.Players.LocalPlayer
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local UIS = game:GetService("UserInputService")

local Window = OrionLib:MakeWindow({
    Name = "Steal A BrainRot",
    HidePremium = false,
    SaveConfig = true,
    ConfigFolder = "OrionTest",
    IntroText = "Loading Script..."
})

OrionLib:MakeNotification({
    Name = "Logged In!",
    Content = "Enjoy " .. Player.Name .. "!",
    Image = "rbxassetid://4483345998",
    Time = 5
})

-- Visuals Tab Enhancements
local playerHighlights = {}
local playerNameGuis = {}
local espEnabled = false
local nameEnabled = false

local function addHighlight(player)
    if player ~= Player and player.Character then
        local highlight = Instance.new("Highlight")
        highlight.FillColor = Color3.new(0, 0, 1) -- Blue
        highlight.OutlineColor = Color3.new(0, 0, 1)
        highlight.FillTransparency = 0.5
        highlight.OutlineTransparency = 0
        highlight.Adornee = player.Character
        highlight.Parent = player.Character
        playerHighlights[player] = highlight
    end
end

local function removeHighlight(player)
    if playerHighlights[player] then
        playerHighlights[player]:Destroy()
        playerHighlights[player] = nil
    end
end

local function addNameGui(player)
    if player ~= Player and player.Character then
        local head = player.Character:WaitForChild("Head")
        local billboard = Instance.new("BillboardGui")
        billboard.AlwaysOnTop = true
        billboard.Size = UDim2.new(0, 200, 0, 50)
        billboard.StudsOffset = Vector3.new(0, 3, 0)
        billboard.Adornee = head
        local textLabel = Instance.new("TextLabel", billboard)
        textLabel.Size = UDim2.new(1, 0, 1, 0)
        textLabel.BackgroundTransparency = 1
        textLabel.Text = player.Name
        textLabel.TextColor3 = Color3.new(1, 1, 1)
        textLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
        textLabel.TextStrokeTransparency = 0
        textLabel.TextScaled = true
        billboard.Parent = head
        playerNameGuis[player] = billboard
    end
end

local function removeNameGui(player)
    if playerNameGuis[player] then
        playerNameGuis[player]:Destroy()
        playerNameGuis[player] = nil
    end
end

-- Visuals Tab
local VisualTab = Window:MakeTab({
    Name = "Visual",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

VisualTab:AddToggle({
    Name = "Players ESP",
    Default = false,
    Callback = function(Value)
        espEnabled = Value
        if espEnabled then
            for _, player in pairs(Players:GetPlayers()) do
                if player.Character then
                    addHighlight(player)
                end
            end
        else
            for player, highlight in pairs(playerHighlights) do
                removeHighlight(player)
            end
        end
    end
})

VisualTab:AddToggle({
    Name = "Players Name",
    Default = false,
    Callback = function(Value)
        nameEnabled = Value
        if nameEnabled then
            for _, player in pairs(Players:GetPlayers()) do
                if player.Character then
                    addNameGui(player)
                end
            end
        else
            for player, gui in pairs(playerNameGuis) do
                removeNameGui(player)
            end
        end
    end
})

-- Event Handling for Players
for _, player in pairs(Players:GetPlayers()) do
    player.CharacterAdded:Connect(function()
        if espEnabled then
            addHighlight(player)
        end
        if nameEnabled then
            addNameGui(player)
        end
    end)
    player.CharacterRemoving:Connect(function()
        removeHighlight(player)
        removeNameGui(player)
    end)
end

Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        if espEnabled then
            addHighlight(player)
        end
        if nameEnabled then
            addNameGui(player)
        end
    end)
    player.CharacterRemoving:Connect(function()
        removeHighlight(player)
        removeNameGui(player)
    end)
end)

Players.PlayerRemoving:Connect(function(player)
    removeHighlight(player)
    removeNameGui(player)
end)

OrionLib:Init()
